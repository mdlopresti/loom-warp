{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://github.com/mdlopresti/loom-warp/schemas/mcp-config.schema.json",
  "title": "Loom Warp Configuration",
  "description": "Configuration schema for Loom Warp project-level settings",
  "type": "object",
  "properties": {
    "namespace": {
      "type": "string",
      "pattern": "^[a-z0-9-]+$",
      "description": "Unique namespace for this project. Auto-generated from path if not specified."
    },
    "channels": {
      "type": "array",
      "description": "List of communication channels for this project",
      "items": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "pattern": "^[a-z0-9-]+$",
            "description": "Channel identifier (lowercase alphanumeric and hyphens)"
          },
          "description": {
            "type": "string",
            "description": "Human-readable channel purpose"
          },
          "maxMessages": {
            "type": "number",
            "minimum": 1,
            "default": 10000,
            "description": "Maximum number of messages to retain"
          },
          "maxBytes": {
            "type": "number",
            "minimum": 1024,
            "default": 10485760,
            "description": "Maximum storage in bytes (default: 10MB)"
          },
          "maxAge": {
            "type": "string",
            "pattern": "^[0-9]+(ns|us|ms|s|m|h|d)$",
            "default": "24h",
            "description": "Maximum message age (e.g., '24h', '7d', '30m')"
          }
        },
        "required": ["name", "description"],
        "additionalProperties": false
      }
    },
    "natsUrl": {
      "type": "string",
      "format": "uri",
      "default": "nats://localhost:4222",
      "description": "NATS server URL. Can be overridden by NATS_URL environment variable."
    },
    "logging": {
      "type": "object",
      "properties": {
        "level": {
          "type": "string",
          "enum": ["DEBUG", "INFO", "WARN", "ERROR"],
          "default": "INFO",
          "description": "Logging verbosity level"
        },
        "format": {
          "type": "string",
          "enum": ["json", "text"],
          "default": "json",
          "description": "Log output format"
        }
      },
      "additionalProperties": false
    },
    "workQueue": {
      "type": "object",
      "properties": {
        "ackTimeoutMs": {
          "type": "number",
          "minimum": 1000,
          "default": 300000,
          "description": "Acknowledgment timeout in milliseconds (default: 300000 = 5 minutes)"
        },
        "maxDeliveryAttempts": {
          "type": "number",
          "minimum": 1,
          "default": 3,
          "description": "Maximum delivery attempts before dead letter (default: 3)"
        },
        "deadLetterTTLMs": {
          "type": "number",
          "minimum": 1000,
          "default": 604800000,
          "description": "Dead letter queue TTL in milliseconds (default: 604800000 = 7 days)"
        }
      },
      "additionalProperties": false,
      "description": "Work queue configuration"
    }
  },
  "additionalProperties": false
}
